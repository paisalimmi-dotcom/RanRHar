# RanRHar ‚Äî ‡∏™‡∏£‡∏∏‡∏õ‡∏™‡∏¥‡πà‡∏á‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á Implement (‡∏à‡∏≤‡∏Å‡∏ó‡∏µ‡πà‡∏Ñ‡∏∏‡∏¢‡∏Å‡∏±‡∏ô)

**Version:** 1.0  
**‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà:** 2026-02-08  
**‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞:** Ready for Implementation

---

## üìã ‡∏™‡∏£‡∏∏‡∏õ‡∏õ‡∏£‡∏∞‡πÄ‡∏î‡πá‡∏ô‡∏ó‡∏µ‡πà‡∏Ñ‡∏∏‡∏¢‡∏Å‡∏±‡∏ô

### 1. ‡∏Å‡∏≤‡∏£‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡πÇ‡∏ï‡πä‡∏∞ (Table Management)

#### ‡∏õ‡∏±‡∏ç‡∏´‡∏≤
- **‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô:** `table_code` ‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡πÄ‡∏Å‡πá‡∏ö‡πÉ‡∏ô DB ‚Üí ‡πÄ‡∏à‡πâ‡∏≤‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà‡πÑ‡∏°‡πà‡∏£‡∏π‡πâ‡∏ß‡πà‡∏≤‡πÇ‡∏ï‡πä‡∏∞‡πÑ‡∏´‡∏ô‡∏™‡∏±‡πà‡∏á
- **‡∏ú‡∏•‡∏Å‡∏£‡∏∞‡∏ó‡∏ö:** ‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô‡πÄ‡∏™‡∏¥‡∏£‡πå‡∏ü‡∏ô‡∏≥‡∏≠‡∏≤‡∏´‡∏≤‡∏£‡πÑ‡∏õ‡∏ú‡∏¥‡∏î‡πÇ‡∏ï‡πä‡∏∞‡πÑ‡∏î‡πâ

#### ‡∏ß‡∏¥‡∏ò‡∏µ‡πÅ‡∏Å‡πâ
- ‚úÖ ‡πÄ‡∏û‡∏¥‡πà‡∏° column `table_code` ‡πÉ‡∏ô‡∏ï‡∏≤‡∏£‡∏≤‡∏á `orders`
- ‚úÖ ‡∏™‡πà‡∏á tableCode ‡πÑ‡∏õ‡πÄ‡∏Å‡πá‡∏ö‡πÉ‡∏ô DB ‡∏ï‡∏≠‡∏ô‡∏™‡∏£‡πâ‡∏≤‡∏á guest order
- ‚úÖ GET /orders ‡∏Ñ‡∏∑‡∏ô tableCode ‡πÉ‡∏´‡πâ‡∏î‡πâ‡∏ß‡∏¢
- ‚úÖ ‡∏´‡∏ô‡πâ‡∏≤ Orders ‡πÅ‡∏•‡∏∞ KDS ‡πÅ‡∏™‡∏î‡∏á‡πÄ‡∏•‡∏Ç‡πÇ‡∏ï‡πä‡∏∞

---

### 2. ‡∏õ‡∏±‡∏ç‡∏´‡∏≤: ‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤‡∏™‡∏±‡πà‡∏á‡∏≠‡∏≤‡∏´‡∏≤‡∏£‡πÅ‡∏•‡πâ‡∏ß‡πÑ‡∏õ‡∏™‡πÅ‡∏Å‡∏ô QR ‡πÇ‡∏ï‡πä‡∏∞‡∏≠‡∏∑‡πà‡∏ô

#### ‡∏™‡∏ñ‡∏≤‡∏ô‡∏Å‡∏≤‡∏£‡∏ì‡πå‡∏õ‡∏±‡∏ç‡∏´‡∏≤
```
‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤‡∏≠‡∏¢‡∏π‡πà‡∏ó‡∏µ‡πà‡πÇ‡∏ï‡πä‡∏∞ A12 ‚Üí ‡∏™‡∏±‡πà‡∏á‡∏≠‡∏≤‡∏´‡∏≤‡∏£‡πÑ‡∏õ‡πÅ‡∏•‡πâ‡∏ß
‚Üì
‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤‡πÄ‡∏ú‡∏•‡∏≠‡πÑ‡∏õ‡∏™‡πÅ‡∏Å‡∏ô QR Code ‡∏Ç‡∏≠‡∏á‡πÇ‡∏ï‡πä‡∏∞ B05
‚Üì
‡∏™‡∏±‡πà‡∏á‡∏≠‡∏≤‡∏´‡∏≤‡∏£‡πÄ‡∏û‡∏¥‡πà‡∏° (‡∏≠‡∏≠‡πÄ‡∏î‡∏≠‡∏£‡πå #2 ‡∏à‡∏≤‡∏Å‡πÇ‡∏ï‡πä‡∏∞ B05)
‚Üì
‡∏õ‡∏±‡∏ç‡∏´‡∏≤: ‡πÄ‡∏à‡πâ‡∏≤‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà‡∏à‡∏∞‡∏ô‡∏≥‡∏≠‡∏≤‡∏´‡∏≤‡∏£‡πÑ‡∏õ‡∏ú‡∏¥‡∏î‡πÇ‡∏ï‡πä‡∏∞!
```

#### ‚úÖ ‡πÅ‡∏ô‡∏ß‡∏ó‡∏≤‡∏á‡∏ó‡∏µ‡πà‡πÄ‡∏•‡∏∑‡∏≠‡∏Å (‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤‡∏™‡∏ö‡∏≤‡∏¢‡πÉ‡∏à + ‡∏£‡∏∞‡∏ö‡∏ö‡πÑ‡∏°‡πà‡πÄ‡∏õ‡πá‡∏ô‡∏õ‡∏±‡∏ç‡∏´‡∏≤)

**‡πÉ‡∏ä‡πâ 2 ‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô:**

1. **‡πÅ‡∏™‡∏î‡∏á‡πÇ‡∏ï‡πä‡∏∞‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô‡∏ä‡∏±‡∏î‡πÄ‡∏à‡∏ô** (‡πÑ‡∏°‡πà‡∏£‡∏ö‡∏Å‡∏ß‡∏ô)
   - ‡πÅ‡∏™‡∏î‡∏á "‡πÇ‡∏ï‡πä‡∏∞ B05" ‡∏ö‡∏ô‡πÄ‡∏°‡∏ô‡∏π‡πÄ‡∏™‡∏°‡∏≠
   - ‡∏ñ‡πâ‡∏≤‡∏°‡∏µ‡∏≠‡∏≠‡πÄ‡∏î‡∏≠‡∏£‡πå‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î‡∏à‡∏≤‡∏Å‡πÇ‡∏ï‡πä‡∏∞‡∏≠‡∏∑‡πà‡∏ô ‚Üí ‡πÅ‡∏™‡∏î‡∏á‡πÅ‡∏ñ‡∏ö‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡πÄ‡∏•‡πá‡∏Å‡πÜ "‡∏Ñ‡∏∏‡∏ì‡πÄ‡∏Ñ‡∏¢‡∏™‡∏±‡πà‡∏á‡∏à‡∏≤‡∏Å‡πÇ‡∏ï‡πä‡∏∞ A12"

2. **‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏Å‡πà‡∏≠‡∏ô Place Order** (‡∏õ‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ô‡∏õ‡∏±‡∏ç‡∏´‡∏≤)
   - ‡∏ñ‡πâ‡∏≤ tableCode ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏à‡∏≤‡∏Å‡∏≠‡∏≠‡πÄ‡∏î‡∏≠‡∏£‡πå‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î ‚Üí ‡πÅ‡∏™‡∏î‡∏á modal ‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô
   - ‡∏ñ‡πâ‡∏≤ tableCode ‡πÄ‡∏î‡∏¥‡∏° ‚Üí ‡∏™‡∏±‡πà‡∏á‡πÑ‡∏î‡πâ‡πÄ‡∏•‡∏¢ (‡πÑ‡∏°‡πà‡∏£‡∏ö‡∏Å‡∏ß‡∏ô)

#### Implementation
- ‡πÄ‡∏Å‡πá‡∏ö `lastOrderTableCode` ‡πÉ‡∏ô sessionStorage ‡∏´‡∏•‡∏±‡∏á‡∏™‡∏±‡πà‡∏á‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à
- ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÄ‡∏õ‡∏¥‡∏î‡πÄ‡∏°‡∏ô‡∏π ‚Üí ‡∏ñ‡πâ‡∏≤ tableCode ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô ‚Üí ‡πÅ‡∏™‡∏î‡∏á‡πÅ‡∏ñ‡∏ö‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô
- ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Å‡πà‡∏≠‡∏ô Place Order ‚Üí ‡∏ñ‡πâ‡∏≤ tableCode ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô ‚Üí ‡πÅ‡∏™‡∏î‡∏á modal ‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô

---

### 3. ‡∏Å‡∏≤‡∏£‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å‡∏≠‡∏≠‡πÄ‡∏î‡∏≠‡∏£‡πå (Cancel Order)

#### ‡∏ô‡πÇ‡∏¢‡∏ö‡∏≤‡∏¢‡∏õ‡∏Å‡∏ï‡∏¥
| ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞ | Cancel ‡πÑ‡∏î‡πâ | ‡∏ú‡∏π‡πâ‡∏ó‡∏µ‡πà Cancel ‡πÑ‡∏î‡πâ |
|-------|------------|-------------------|
| **PENDING** | ‚úÖ ‡πÑ‡∏î‡πâ | ‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤, ‡πÄ‡∏à‡πâ‡∏≤‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà, ‡∏ú‡∏π‡πâ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£ |
| **CONFIRMED** | ‚ùå ‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ | - |
| **COMPLETED** | ‚ùå ‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ | - |
| **PAID** | ‚ùå ‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ | - |

**‡πÄ‡∏´‡∏ï‡∏∏‡∏ú‡∏•:** Cancel ‡πÑ‡∏î‡πâ‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡∏ó‡∏≥‡∏≠‡∏≤‡∏´‡∏≤‡∏£ (PENDING ‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô)

#### ‡∏Å‡∏£‡∏ì‡∏µ‡∏û‡∏¥‡πÄ‡∏®‡∏© ‚Äî ‡∏ú‡∏π‡πâ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô
| ‡∏™‡∏ñ‡∏≤‡∏ô‡∏Å‡∏≤‡∏£‡∏ì‡πå | ‡∏ú‡∏π‡πâ‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£ | ‡πÄ‡∏á‡∏∑‡πà‡∏≠‡∏ô‡πÑ‡∏Ç |
|-----------|-------------|----------|
| ‡∏≠‡∏≤‡∏´‡∏≤‡∏£‡∏°‡∏µ‡∏õ‡∏±‡∏ç‡∏´‡∏≤ (‡∏Ñ‡∏∏‡∏ì‡∏†‡∏≤‡∏û, ‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á, ‡πÄ‡∏™‡∏µ‡∏¢‡∏´‡∏≤‡∏¢) | **‡∏ú‡∏π‡πâ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£** | Cancel ‡πÑ‡∏î‡πâ‡πÅ‡∏°‡πâ CONFIRMED/COMPLETED |
| ‡∏ï‡πâ‡∏≠‡∏á‡∏ó‡∏≥‡πÉ‡∏´‡πâ‡πÉ‡∏´‡∏°‡πà | **‡∏ú‡∏π‡πâ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£** | Cancel ‡∏≠‡∏≠‡πÄ‡∏î‡∏≠‡∏£‡πå‡πÄ‡∏î‡∏¥‡∏° ‚Üí ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏≠‡∏≠‡πÄ‡∏î‡∏≠‡∏£‡πå‡πÉ‡∏´‡∏°‡πà |
| ‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤‡πÑ‡∏°‡πà‡∏û‡∏≠‡πÉ‡∏à | **‡∏ú‡∏π‡πâ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£** | Cancel + Refund (‡∏ñ‡πâ‡∏≤‡∏ä‡∏≥‡∏£‡∏∞‡πÅ‡∏•‡πâ‡∏ß) |

#### ‡∏™‡∏¥‡πà‡∏á‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡πÄ‡∏Å‡πá‡∏ö‡πÉ‡∏ô‡∏£‡∏∞‡∏ö‡∏ö
- `cancelled_at` ‚Äî ‡πÄ‡∏ß‡∏•‡∏≤‡∏ó‡∏µ‡πà Cancel
- `cancelled_by` ‚Äî ‡πÉ‡∏Ñ‡∏£ Cancel (user_id)
- `cancel_reason` ‚Äî ‡πÄ‡∏´‡∏ï‡∏∏‡∏ú‡∏• (‡∏õ‡∏Å‡∏ï‡∏¥/‡∏õ‡∏±‡∏ç‡∏´‡∏≤)
- `refund_required` ‚Äî ‡∏ï‡πâ‡∏≠‡∏á Refund ‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà

---

## üéØ ‡∏™‡∏¥‡πà‡∏á‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á Implement

### Phase 1: ‡πÄ‡∏Å‡πá‡∏ö‡πÅ‡∏•‡∏∞‡πÅ‡∏™‡∏î‡∏á‡πÄ‡∏•‡∏Ç‡πÇ‡∏ï‡πä‡∏∞ (URGENT)

#### Database
```sql
-- Migration: ‡πÄ‡∏û‡∏¥‡πà‡∏° table_code ‡πÉ‡∏ô orders
ALTER TABLE orders ADD COLUMN table_code VARCHAR(50);
CREATE INDEX idx_orders_table_code ON orders(table_code);
```

#### Backend API
- ‚úÖ `POST /orders/guest` ‚Äî ‡πÄ‡∏Å‡πá‡∏ö tableCode ‡πÉ‡∏ô DB
- ‚úÖ `GET /orders` ‚Äî ‡∏Ñ‡∏∑‡∏ô tableCode ‡πÉ‡∏´‡πâ‡∏î‡πâ‡∏ß‡∏¢
- ‚úÖ `PATCH /orders/:id/status` ‚Äî ‡∏Ñ‡∏∑‡∏ô tableCode (‡∏ñ‡πâ‡∏≤‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£)

#### Frontend
- ‚úÖ ‡∏´‡∏ô‡πâ‡∏≤ Orders ‚Äî ‡πÅ‡∏™‡∏î‡∏á‡∏Ñ‡∏≠‡∏•‡∏±‡∏°‡∏ô‡πå "‡πÇ‡∏ï‡πä‡∏∞" (table_code)
- ‚úÖ ‡∏´‡∏ô‡πâ‡∏≤ KDS ‚Äî ‡πÅ‡∏™‡∏î‡∏á‡πÄ‡∏•‡∏Ç‡πÇ‡∏ï‡πä‡∏∞‡πÉ‡∏ô‡∏≠‡∏≠‡πÄ‡∏î‡∏≠‡∏£‡πå
- ‚úÖ ‡∏´‡∏ô‡πâ‡∏≤ Staff/Tables ‚Äî ‡πÅ‡∏™‡∏î‡∏á‡πÄ‡∏•‡∏Ç‡πÇ‡∏ï‡πä‡∏∞

---

### Phase 2: ‡∏õ‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ô‡∏™‡πÅ‡∏Å‡∏ô QR ‡πÇ‡∏ï‡πä‡∏∞‡∏ú‡∏¥‡∏î

#### Frontend Logic
1. **‡πÄ‡∏Å‡πá‡∏ö lastOrderTableCode**
   ```typescript
   // ‡∏´‡∏•‡∏±‡∏á‡∏™‡∏±‡πà‡∏á‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à
   sessionStorage.setItem('lastOrderTableCode', tableCode);
   ```

2. **‡πÅ‡∏™‡∏î‡∏á‡πÇ‡∏ï‡πä‡∏∞‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô‡∏ä‡∏±‡∏î‡πÄ‡∏à‡∏ô**
   - ‡πÅ‡∏™‡∏î‡∏á "‡πÇ‡∏ï‡πä‡∏∞ B05" ‡∏ö‡∏ô‡πÄ‡∏°‡∏ô‡∏π‡πÄ‡∏™‡∏°‡∏≠ (‡∏°‡∏µ‡∏≠‡∏¢‡∏π‡πà‡πÅ‡∏•‡πâ‡∏ß)
   - ‡∏ñ‡πâ‡∏≤‡∏°‡∏µ `lastOrderTableCode` ‡πÅ‡∏•‡∏∞‡πÑ‡∏°‡πà‡∏ï‡∏£‡∏á‡∏Å‡∏±‡∏ö‡πÇ‡∏ï‡πä‡∏∞‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô ‚Üí ‡πÅ‡∏™‡∏î‡∏á‡πÅ‡∏ñ‡∏ö‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô

3. **‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏Å‡πà‡∏≠‡∏ô Place Order**
   ```typescript
   // ‡πÉ‡∏ô checkout page
   const lastTable = sessionStorage.getItem('lastOrderTableCode');
   if (lastTable && lastTable !== currentTableCode) {
     // ‡πÅ‡∏™‡∏î‡∏á modal ‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô
     showConfirmModal('‡∏Ñ‡∏∏‡∏ì‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏™‡∏±‡πà‡∏á‡πÑ‡∏õ‡∏ó‡∏µ‡πà‡πÇ‡∏ï‡πä‡∏∞ B05 ‡πÅ‡∏ï‡πà‡πÄ‡∏Ñ‡∏¢‡∏™‡∏±‡πà‡∏á‡∏à‡∏≤‡∏Å‡πÇ‡∏ï‡πä‡∏∞ A12');
   }
   ```

#### Components ‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á
- `TableWarningBanner` ‚Äî ‡πÅ‡∏ñ‡∏ö‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÇ‡∏ï‡πä‡∏∞
- `ConfirmTableChangeModal` ‚Äî Modal ‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏Å‡πà‡∏≠‡∏ô‡∏™‡∏±‡πà‡∏á

---

### Phase 3: Cancel Order

#### Database
```sql
-- ‡πÄ‡∏û‡∏¥‡πà‡∏° status CANCELLED
ALTER TABLE orders DROP CONSTRAINT orders_status_check;
ALTER TABLE orders ADD CONSTRAINT orders_status_check 
  CHECK (status IN ('PENDING', 'CONFIRMED', 'COMPLETED', 'CANCELLED'));

-- ‡πÄ‡∏û‡∏¥‡πà‡∏° columns ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö Cancel
ALTER TABLE orders ADD COLUMN cancelled_at TIMESTAMP;
ALTER TABLE orders ADD COLUMN cancelled_by INTEGER REFERENCES users(id);
ALTER TABLE orders ADD COLUMN cancel_reason TEXT;
ALTER TABLE orders ADD COLUMN refund_required BOOLEAN DEFAULT FALSE;
```

#### Backend API
- `PATCH /orders/:id/status` ‚Äî ‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö `status: 'CANCELLED'`
- ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö:
  - ‡∏ñ‡πâ‡∏≤ PENDING ‚Üí Cancel ‡πÑ‡∏î‡πâ (‡∏ó‡∏∏‡∏Å‡∏Ñ‡∏ô)
  - ‡∏ñ‡πâ‡∏≤ CONFIRMED/COMPLETED ‚Üí Cancel ‡πÑ‡∏î‡πâ‡πÄ‡∏â‡∏û‡∏≤‡∏∞ Manager
  - ‡∏ñ‡πâ‡∏≤ PAID ‚Üí Cancel ‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ (‡∏ï‡πâ‡∏≠‡∏á Refund ‡πÅ‡∏ó‡∏ô)

#### Frontend
- ‡∏´‡∏ô‡πâ‡∏≤ Order Status ‚Äî ‡∏õ‡∏∏‡πà‡∏° Cancel (‡∏ñ‡πâ‡∏≤ PENDING)
- ‡∏´‡∏ô‡πâ‡∏≤ Orders (Manager) ‚Äî ‡∏õ‡∏∏‡πà‡∏° Cancel (‡∏Å‡∏£‡∏ì‡∏µ‡∏û‡∏¥‡πÄ‡∏®‡∏©)
- Modal ‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô Cancel + ‡∏Å‡∏£‡∏≠‡∏Å‡πÄ‡∏´‡∏ï‡∏∏‡∏ú‡∏• (‡∏ñ‡πâ‡∏≤ Manager)

---

### Phase 4: ‡∏´‡∏ô‡πâ‡∏≤ Order Status ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤

#### Route
- `/order/status/[id]?table=A12`
- ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö: ‡∏ñ‡πâ‡∏≤ tableCode ‡∏ï‡∏£‡∏á‡∏Å‡∏±‡∏ö order ‡∏ñ‡∏∂‡∏á‡πÅ‡∏™‡∏î‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•

#### Features
- ‡πÅ‡∏™‡∏î‡∏á: ‡πÄ‡∏•‡∏Ç‡∏≠‡∏≠‡πÄ‡∏î‡∏≠‡∏£‡πå, ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£, ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞, ‡πÄ‡∏•‡∏Ç‡πÇ‡∏ï‡πä‡∏∞
- ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï: ‡∏ó‡∏∏‡∏Å 30 ‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ ‡∏´‡∏£‡∏∑‡∏≠ WebSocket
- ‡∏õ‡∏∏‡πà‡∏° Cancel (‡∏ñ‡πâ‡∏≤ PENDING)
- ‡∏•‡∏¥‡∏á‡∏Å‡πå‡∏à‡∏≤‡∏Å‡∏´‡∏ô‡πâ‡∏≤ Order Success

---

## üìä ‡∏™‡∏£‡∏∏‡∏õ Checklist

### Database Changes
- [ ] ‡πÄ‡∏û‡∏¥‡πà‡∏° `table_code` ‡πÉ‡∏ô orders
- [ ] ‡πÄ‡∏û‡∏¥‡πà‡∏° `CANCELLED` ‡πÉ‡∏ô order status
- [ ] ‡πÄ‡∏û‡∏¥‡πà‡∏° `cancelled_at`, `cancelled_by`, `cancel_reason`, `refund_required`

### Backend API
- [ ] ‡πÄ‡∏Å‡πá‡∏ö tableCode ‡πÉ‡∏ô POST /orders/guest
- [ ] ‡∏Ñ‡∏∑‡∏ô tableCode ‡πÉ‡∏ô GET /orders
- [ ] ‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö Cancel ‡πÉ‡∏ô PATCH /orders/:id/status
- [ ] ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå Cancel (PENDING vs Manager)

### Frontend
- [ ] ‡πÅ‡∏™‡∏î‡∏á‡πÄ‡∏•‡∏Ç‡πÇ‡∏ï‡πä‡∏∞‡πÉ‡∏ô Orders/KDS
- [ ] ‡πÄ‡∏Å‡πá‡∏ö lastOrderTableCode ‡πÉ‡∏ô sessionStorage
- [ ] ‡πÅ‡∏™‡∏î‡∏á‡πÅ‡∏ñ‡∏ö‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÇ‡∏ï‡πä‡∏∞
- [ ] Modal ‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏Å‡πà‡∏≠‡∏ô Place Order (‡∏ñ‡πâ‡∏≤‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÇ‡∏ï‡πä‡∏∞)
- [ ] ‡∏´‡∏ô‡πâ‡∏≤ Order Status ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤
- [ ] ‡∏õ‡∏∏‡πà‡∏° Cancel ‡πÉ‡∏ô Order Status (‡∏ñ‡πâ‡∏≤ PENDING)
- [ ] ‡∏õ‡∏∏‡πà‡∏° Cancel ‡πÉ‡∏ô Orders (Manager, ‡∏Å‡∏£‡∏ì‡∏µ‡∏û‡∏¥‡πÄ‡∏®‡∏©)

---

## üîÑ Flow ‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á Implement

### Flow: ‡∏™‡∏±‡πà‡∏á‡∏≠‡∏≤‡∏´‡∏≤‡∏£ (‡∏õ‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ô‡∏™‡πÅ‡∏Å‡∏ô QR ‡∏ú‡∏¥‡∏î)
```
‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤‡πÄ‡∏õ‡∏¥‡∏î /menu/B05
  ‚Üì
‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö: ‡∏°‡∏µ lastOrderTableCode?
  ‚Üì
‡∏ñ‡πâ‡∏≤‡∏°‡∏µ‡πÅ‡∏•‡∏∞‡πÑ‡∏°‡πà‡∏ï‡∏£‡∏á ‚Üí ‡πÅ‡∏™‡∏î‡∏á‡πÅ‡∏ñ‡∏ö‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô "‡∏Ñ‡∏∏‡∏ì‡πÄ‡∏Ñ‡∏¢‡∏™‡∏±‡πà‡∏á‡∏à‡∏≤‡∏Å‡πÇ‡∏ï‡πä‡∏∞ A12"
  ‚Üì
‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏≠‡∏≤‡∏´‡∏≤‡∏£ ‚Üí ‡∏Å‡∏î Place Order
  ‚Üì
‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö: tableCode ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô?
  ‚Üì
‡∏ñ‡πâ‡∏≤‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô ‚Üí ‡πÅ‡∏™‡∏î‡∏á Modal ‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô
  ‚Üì
‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô ‚Üí ‡∏™‡∏±‡πà‡∏á‡∏≠‡∏≤‡∏´‡∏≤‡∏£ (‡πÄ‡∏Å‡πá‡∏ö tableCode ‡πÉ‡∏ô DB)
  ‚Üì
‡πÄ‡∏Å‡πá‡∏ö lastOrderTableCode = B05
```

### Flow: Cancel Order
```
‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤/‡πÄ‡∏à‡πâ‡∏≤‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà ‡∏Ç‡∏≠ Cancel
  ‚Üì
‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö: status === 'PENDING'?
  ‚Üì
‡πÉ‡∏ä‡πà ‚Üí Cancel ‡πÑ‡∏î‡πâ‡∏ó‡∏±‡∏ô‡∏ó‡∏µ
  ‚Üì
‡πÑ‡∏°‡πà‡πÉ‡∏ä‡πà ‚Üí ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö: role === 'manager'?
  ‚Üì
‡πÉ‡∏ä‡πà ‚Üí ‡πÅ‡∏™‡∏î‡∏á Modal ‡∏Å‡∏£‡∏≠‡∏Å‡πÄ‡∏´‡∏ï‡∏∏‡∏ú‡∏• ‚Üí Cancel
  ‚Üì
‡πÑ‡∏°‡πà‡πÉ‡∏ä‡πà ‚Üí ‡πÅ‡∏™‡∏î‡∏á error "Cancel ‡πÑ‡∏î‡πâ‡πÄ‡∏â‡∏û‡∏≤‡∏∞ PENDING"
```

---

## üìù ‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏

- **Priority:** Phase 1 (‡πÄ‡∏Å‡πá‡∏ö table_code) = URGENT
- **UX Focus:** ‡πÑ‡∏°‡πà‡∏£‡∏ö‡∏Å‡∏ß‡∏ô‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤ ‡πÅ‡∏ï‡πà‡∏õ‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ô‡∏õ‡∏±‡∏ç‡∏´‡∏≤
- **Security:** Manager ‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô‡∏ó‡∏µ‡πà Cancel ‡πÑ‡∏î‡πâ‡πÉ‡∏ô‡∏Å‡∏£‡∏ì‡∏µ‡∏û‡∏¥‡πÄ‡∏®‡∏©

---

*‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡∏ô‡∏µ‡πâ‡∏≠‡πâ‡∏≤‡∏á‡∏≠‡∏¥‡∏á‡∏à‡∏≤‡∏Å CUSTOMER_TABLE_UX_GUIDE.md ‡πÅ‡∏•‡∏∞‡∏Å‡∏≤‡∏£‡∏™‡∏ô‡∏ó‡∏ô‡∏≤ 2026-02-08*
